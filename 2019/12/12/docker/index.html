<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>docker | 而废不能半途</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="[object Object]"><meta name="designer" content="minfive"><meta name="keywords" content="double-c, chao, 后端, 程序员, laravel, php"><meta name="description" content="总不能还没有努力就向生活妥协。"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="all"><link rel="canonical" href="https://double-c.github.io/2019/12/12/docker/index.html"><link rel="icon" type="image/png" href="/img/favicon.ico" sizes="32x32"><link rel="stylesheet" href="/scss/base/index.css"><link rel="alternate" href="/atom.xml" title="Double-c"><link rel="stylesheet" href="/scss/views/page/post.css"></head><body ontouchstart><div id="page-loading" class="page page-loading" style="background-image:url(/img/loader.gif)"></div><div id="page" class="page js-hidden"><header class="page__small-header page__header--small"><nav class="page__navbar"><div class="page__container navbar-container"><a class="page__logo" href="/" title="Double-c" alt="Double-c"><img src="/img/chao-logo-white.png" alt="Double-c"></a><nav class="page__nav"><ul class="nav__list clearfix"><li class="nav__item"><a href="/" alt="首页" title="首页">首页</a></li><li class="nav__item"><a href="/archives" alt="归档" title="归档">归档</a></li><li class="nav__item"><a href="/about" alt="关于" title="关于">关于</a></li></ul></nav><button class="page__menu-btn" type="button"><i class="iconfont icon-menu"></i></button></div></nav></header><main class="page__container page__main"><div class="page__content"><article class="page__post"><div class="post__cover"><img src="/img/posts/docker.png" alt="docker"></div><header class="post__info"><h1 class="post__title">docker</h1><div class="post__mark"><div class="mark__block"><i class="mark__icon iconfont icon-write"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="https://github.com/Double-C">chao</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-time"></i><ul class="mark__list clearfix"><li class="mark__item"><span>2019-12-12</span></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-tab"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/tags/php/">Php</a></li></ul></div></div></header><div class="post__content"><h2 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h2><h4 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h4><ul><li><a href="#前言">前言</a></li><li><a href="#虚拟机与Docker">虚拟机与Docker</a></li><li><a href="#Docker的用途">Docker的用途</a></li><li><a href="#镜像">镜像</a></li><li><a href="#容器">容器</a></li><li><a href="#仓库">仓库</a></li></ul><h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>开发者常常会说「 这个程序在我的机器里是可以跑通的 」</p><p>那么在别的机器里可能因为环境不一致而导致出现异常</p><p>环境配置如此麻烦，你每换一台机器就要重来一次</p><p>能不能在部署代码的时候，将原始环境一模一样的复制过来呢？</p><p>Docker 确保了执行环境的一致性，使得应用迁移更加容易</p><p>Docker 可以在很多平台上运行，无论是物理机、虚拟机、公有云、私有云，甚至是笔记本，其运行结果是一致的</p><p>因此用户可以很轻易的将在一个平台上运行的应用，迁移到另一个平台上，而不用担心运行环境的变化</p><h4 id="虚拟机与Docker"><a href="#虚拟机与Docker" class="headerlink" title="虚拟机与Docker"></a>虚拟机与Docker</h4><p>虚拟机就是开发环境安装的一种解决方案，它可以在一个操作系里面运行另一个操作系统</p><blockquote><p>比如在 windows 上运行 Linux 系统</p></blockquote><p>应用程序对此毫无感知，因为虚拟机跟真实的系统一模一样，但是缺点是：</p><ol><li><p>资源占用多</p><p>虚拟机会独占一部分内存和硬盘，它运行的时候，其他程序就不能使用这些资源了</p></li><li><p>启动慢</p><p>启动操作系统需要多久，启动虚拟机就需要多久</p></li></ol><p>Docker 在 Linux 容器上进行进一步封装，提供简单易用的容器使用接口</p><p>优点在于：</p><ol><li><p>由于容器不用硬件虚拟以及运行完整的操作系统</p><blockquote><p><strong>启动容器相当于启动本机的一个进程</strong>，而不是启动一个操作系统</p></blockquote></li><li><p>容器只占用需要的资源，不占用那些没有用到的资源</p><blockquote><p>多个容器可以共享资源，而虚拟机都是独享资源</p></blockquote></li><li><p>容器体积小，只包含用到的组件即可</p></li></ol><h4 id="Docker的用途"><a href="#Docker的用途" class="headerlink" title="Docker的用途"></a>Docker的用途</h4><ol><li>提供一次性的环境：比如本地测试他人的软件</li><li>提供弹性的云服务：因为 Docker 容器可以随开随关，很适合动态扩容</li><li>组件微服务架构：通过多个容器，一台机器可以跑多个服务，<strong>因此在本机就可以模拟出微服务架构</strong></li><li>方便团队理解开发环境：使用 Dockerfile 让镜像构建透明化</li></ol><blockquote><p>不仅仅开发团队可以理解应用环境</p><p>也方便运维团队理解应用运行所需条件，帮助更好的生产环境中部署该镜像</p></blockquote><h4 id="镜像"><a href="#镜像" class="headerlink" title="镜像"></a>镜像</h4><p>Docker镜像是一个特殊的文件系统，除了提供容器运行时所需的程序、库、资源、配置等文件外</p><p>还包含了一些为运行时准备的一些配置参数（如匿名卷、环境变量、用户等）</p><p>镜像不包含任何动态数据 ，其<strong>内容在构建之后也不会被改变</strong></p><p>镜像并非像一个 ISO 那样的打包文件，由<strong>多层文件</strong>系统联合组成</p><p>镜像构建时，会一层层构建，前一层是后一层的基础。</p><p>每一层构建完就不会再发生改变，<strong>后一层上的任何改变只发生在自己这一层</strong></p><p>任何额外的东西在该层构建结束前清理掉</p><p>这样使得镜像的复用、定制更为容易</p><h4 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h4><p>容器实质是进程，容器可以被创建、启动、停止、删除、暂停等</p><p>但是与直接运行在宿主执行的进程不同，<strong>容器进程运行于属于自己的独立的命名空间</strong></p><p>因此容器可以拥有自己的 <code>root</code> 文件系统、自己的网络配置、自己的进程空间，甚至自己的用户ID空间</p><p>每一个容器运行时，是以镜像为基础层，在其上创建一个当前容器的存储层</p><p>我们可以称这个为容器运行时读写而准备的存储层为 <strong>容器存储层</strong></p><p>容器存储层的生命周期和容器一样，容器消亡时，容器存储层也随之消亡</p><blockquote><p><strong>因此，任何存于容器存储层的信息都会随容器删除而丢失</strong></p></blockquote><p><strong>关于文件写入操作</strong></p><p>Docker 最佳实践要求，容器不应该向其存储层内写入任何数据，容器存储层要保持无状态化</p><p>所有的文件写入操作都应该使用 「 数据卷（Volume） 」、或者绑定宿主目录</p><p>在这些位置的读写会跳过容器存储层，直接对宿主（或网络存储）发生读写，其性能和稳定性更高</p><blockquote><p>数据卷的生命周期独立于容器，容器消亡 ，数据卷不会消亡</p><p><strong>因此使用数据卷后，容器删除或者重新运行之后，数据不会丢失</strong></p></blockquote><p><strong>容器与镜像</strong></p><p>镜像和容器的关系更像是面向对象程序设计中的类和实例的关系一样</p><p><strong>镜像是静态的定义，容器是镜像运行时的主体</strong></p><blockquote><p>有个坑容器如果启动后没有一直挂起的命令，就会自动退出</p><p>也就是docker容器后台运行必须有一个前台进程</p><p>可以使用 <code>tail -f /code/test.log</code></p></blockquote><h4 id="仓库"><a href="#仓库" class="headerlink" title="仓库"></a>仓库</h4><p>镜像构建完成后，可以很容易在当前宿主机器上运行</p><p>但是如果需要在其他服务器上使用这个镜像</p><p>我们就需要一个集中存储分发镜像的服务</p><p><a href="https://yeasy.gitbooks.io/docker_practice/repository/registry.html" target="_blank" rel="noopener">Docker Registry</a> 就是一个这样的服务</p><blockquote><p>Docker Registry 中可以包含多个仓库</p><p>每个仓库可以包含多个标签</p><p><strong>每一个标签对应一个镜像</strong></p></blockquote><p>以 Ubuntu 为例， <code>ubuntu</code> 是仓库的名字，里面包含有不同的版本标签，如 <code>16.04</code>，<code>18.04</code></p><p>我们可以通过 <code>ubuntu:16:04</code> 来具体指定所需哪个版本的镜像</p><p>如果忽略了标签，那么最终将视为 <code>ubuntu:latest</code></p><div class="post-announce">感谢您的阅读，本文由 <a href="https://double-c.github.io">Double-c</a> 版权所有。如若转载，请注明出处：Double-c（<a href="https://double-c.github.io/2019/12/12/docker/">https://double-c.github.io/2019/12/12/docker/</a>）</div><div class="post__prevs"><div class="post__prev"><a href="/2019/07/05/code-life/" title="code-life"><i class="iconfont icon-prev"></i>code-life</a></div><div class="post__prev post__prev--right"></div></div></div></article><div id="comment-container"></div></div><aside class="page__sidebar"><form id="page-search-from" class="page__search-from" action="/search/"><label class="search-form__item"><input class="input" type="text" name="search" placeholder="Search..."> <i class="iconfont icon-search"></i></label></form><div class="sidebar__block"><h3 class="block__title">简介</h3><p class="block__text">总不能还没有努力就向生活妥协。</p></div><div class="sidebar__block"><h3 class="block__title">文章分类</h3><ul class="block-list"><li class="block-list-item"><a class="block-list-link" href="/categories/那些年踩过的坑/">那些年踩过的坑</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/运维笔记/">运维笔记</a><span class="block-list-count">3</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/更好的自己/">更好的自己</a><span class="block-list-count">2</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/后端开发/">后端开发</a><span class="block-list-count">14</span></li></ul></div><div class="sidebar__block"><h3 class="block__title">最新文章</h3><ul class="block-list latest-post-list"><li class="latest-post-item"><a href="/2019/12/12/docker/" title="docker"><div class="item__cover"><img src="/img/posts/docker.png" alt="docker"></div><div class="item__info"><h3 class="item__title">docker</h3><span class="item__text">2019-12-12</span></div></a></li><li class="latest-post-item"><a href="/2019/07/05/code-life/" title="code-life"><div class="item__cover"><img src="/img/posts/code-life.jpg" alt="code-life"></div><div class="item__info"><h3 class="item__title">code-life</h3><span class="item__text">2019-07-05</span></div></a></li><li class="latest-post-item"><a href="/2019/06/20/mysql-transformer/" title="MySQL隐式转换"><div class="item__cover"><img src="/img/posts/transformer.jpg" alt="MySQL隐式转换"></div><div class="item__info"><h3 class="item__title">MySQL隐式转换</h3><span class="item__text">2019-06-20</span></div></a></li><li class="latest-post-item"><a href="/2019/06/20/my-vps-install/" title="my-vps-install"><div class="item__cover"><img src="/img/posts/tizi.png" alt="my-vps-install"></div><div class="item__info"><h3 class="item__title">my-vps-install</h3><span class="item__text">2019-06-20</span></div></a></li></ul></div><div class="sidebar__block"><h3 class="block__title">文章标签</h3><ul class="block-list tag-list clearfix"><li class="tag-item"><a class="tag-link" href="/tags/api/">api</a></li><li class="tag-item"><a class="tag-link" href="/tags/git/">git</a></li><li class="tag-item"><a class="tag-link" href="/tags/http/">http</a></li><li class="tag-item"><a class="tag-link" href="/tags/laravel/">laravel</a></li><li class="tag-item"><a class="tag-link" href="/tags/linux/">linux</a></li><li class="tag-item"><a class="tag-link" href="/tags/mac/">mac</a></li><li class="tag-item"><a class="tag-link" href="/tags/mysql/">mysql</a></li><li class="tag-item"><a class="tag-link" href="/tags/php/">php</a></li><li class="tag-item"><a class="tag-link" href="/tags/yii2-0/">yii2.0</a></li><li class="tag-item"><a class="tag-link" href="/tags/人艰不拆/">人艰不拆</a></li><li class="tag-item"><a class="tag-link" href="/tags/自律/">自律</a></li></ul></div></aside></main><footer class="page__footer"><section class="footer__top"><div class="page__container footer__container"><div class="footer-top__item footer-top__item--4"><h3 class="item__title">关于</h3><div class="item__content"><p class="item__text">本站是基于 Hexo 搭建的静态资源博客，主要用于分享日常学习、生活及工作的一些心得总结，欢迎点击右下角订阅 rss。</p><ul class="footer__contact-info"><li class="contact-info__item"><i class="iconfont icon-address"></i> <span>Shantou, Guangdong Province, China</span></li><li class="contact-info__item"><i class="iconfont icon-email2"></i> <span>chenchao_cn@qq.com</span></li></ul></div></div><div class="footer-top__item"><h3 class="item__title">友情链接</h3><div class="item__content"><ul class="footer-top__list"><li class="list-item"><a href="https://github.com/Mrminfive/hexo-theme-skapp" title="hexo-theme-skapp" target="_blank">hexo-theme-skapp</a></li></ul></div></div><div class="footer-top__item"><h3 class="item__title">构建工具</h3><div class="item__content"><ul class="footer-top__list"><li class="list-item"><a href="https://hexo.io/" title="Blog Framework" target="_blank">Hexo</a></li></ul></div></div></div></section><section class="footer__bottom"><div class="page__container footer__container"><p class="footer__copyright">© <a href="https://github.com/Mrminfive/hexo-theme-skapp" target="_blank">Skapp</a> 2017 powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, made by <a href="https://github.com/Mrminfive" target="_blank">minfive</a>.</p><ul class="footer__social-network clearfix"><li class="social-network__item"><a href="https://github.com/Double-C" target="_blank" title="github"><i class="iconfont icon-github"></i></a></li><li class="social-network__item"><a href="mailto:chenchao_cn@qq.com" target="_blank" title="email"><i class="iconfont icon-email"></i></a></li><li class="social-network__item"><a href="/atom.xml" target="_blank" title="rss"><i class="iconfont icon-rss"></i></a></li></ul></div></section></footer><div id="back-top" class="back-top back-top--hidden js-hidden"><i class="iconfont icon-top"></i></div></div><script src="/js/common.js"></script><script src="/js/page/post.js"></script><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="/js/md5.min.js"></script><script>var tags=["php"],gitalk=new Gitalk({clientID:"0ab6fbc345e392e6cfb9",clientSecret:"a00e86d6d283eb80bfb5138b1a23e756654883b6",repo:"double-c.github.io",owner:"Double-C",admin:["Double-C"],labels:tags,id:new Date(1576136843e3).getTime()>new Date("2018-02-15").getTime()?md5(location.pathname):location.pathname});gitalk.render("comment-container")</script><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>